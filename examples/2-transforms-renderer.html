<!DOCTYPE html>
<html>
  <head>
    <title>2-Transforms-Renderer</title>
  </head>
  <body>
    <style type="text/css">
      html, body {
        padding: 0;
        margin: 0;
        overflow: hidden;
        width: 100%;
        height: 100%;
      }
      canvas {
        width: 100%;
        height: 100%;
      }
    </style>
    <script type="text/javascript" src="../build/grapher.js"></script>
    <script type="text/javascript" src="../build/renderer.js"></script>
    <script type="text/javascript">
    function draw () {
      var canvas = document.getElementById("canvas");
      var height = window.innerHeight;
      var width = window.innerWidth;
      var nodes = [];
      var links = [];
      var numOfNodes = 100;
      var numOfLinks = numOfNodes * 2;
      for (var i = 0; i < numOfNodes; i++) {
        node = { 
          color: randomInt(0, 256) * 256 * 256 + randomInt(0, 256) * 256 + randomInt(0, 256),
          x: randomInt(30, width),
          y: randomInt(30, height),
          r: randomInt(10, 30)
        }
        nodes.push(node);
      }

      for (var i = 0; i < numOfLinks; i++ ) {
        var firstNode = randomInt(0, numOfNodes - 1);
        var secondNode = randomInt(0, numOfNodes - 1);
        var link = {
          x1: nodes[firstNode].x, 
          y1: nodes[firstNode].y,
          x2: nodes[secondNode].x, 
          y2: nodes[secondNode].y,
          color : nodes[firstNode].color
        }
        links.push(link);
      }

      var renderer = new Renderer({
        canvas: canvas,
        width: width,
        height: height,
        linkWidth: 2
      });

      renderer.setNodes(nodes);
      renderer.setLinks(links);
      renderer.render();

      var grapher = new Ayasdi.Grapher(canvas.width, canvas.height);

      window.onmousewheel = function (e) {
        var transform = grapher.transform(),
            delta = e.wheelDelta / 5000,
            fromCenterX = e.offsetX - width / 2;
            fromCenterY = e.offsetY - height / 2;

        transform.scale = transform.scale + delta;
        transform.translate = [
          transform.translate[0] + fromCenterX * delta,
          transform.translate[1] + fromCenterY * delta,
        ];
        
        grapher.transform(transform);
        var newTransform = grapher.transform(); 

        renderer.setScale(newTransform.scale);
        renderer.setTranslate(newTransform.translate);

        renderer.render();

      };


    }

      function randomInt (min,max) { return Math.floor(Math.random() * (max - min + 1) + min); }
    </script>
  <body onload="draw();">
    <canvas id="canvas" style="border: none;"></canvas>
  </body>
</html>